def commitHasVersionTag() {
	def isVersion = (env.CURRENT_TAG =~ /^(\d+\.)?(\d+\.)?(\*|\d+)$/)
	return isVersion
}


node {

    stage("Checkout") {
        cleanWs()
        checkout scm
				env.CURRENT_TAG = sh(returnStdout: true, script: "git tag -l --points-at HEAD |tail -1").trim()
				BRANCH_NAME = env.BRANCH_NAME.replaceAll('[^A-Za-z0-9]','_');
    }

		stage("Run") {
      sh "export GPG_TTY=\$(tty)"
      sh "COMET_API_KEY=Vbc3cTFyjrWODd186oLEkHa2k COMET_PROJECT_NAME=java-sdk COMET_WORKSPACE_NAME=javasdktestuser mvn --batch-mode release:clean release:prepare -pl comet-java-client -am release:perform"
		}

}
